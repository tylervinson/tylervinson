<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Weekly Calendar Form</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.4.0/jspdf.umd.min.js"></script>
  <link rel="stylesheet" href="https://unpkg.com/material-components-web@latest/dist/material-components-web.min.css">
  <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
  <link rel="stylesheet" href="https://code.getmdl.io/1.3.0/material.indigo-pink.min.css">
  <link rel="stylesheet" href="https://code.getmdl.io/1.3.0/material.blue-deep_purple.min.css" />
</head>
<body>
  <form id="weekly-calendar-form">
    <h1>Weekly Calendar</h1>
    <div id="calendar-container"></div>
    <button type="button" onclick="generatePDF()">Submit and Generate PDF</button>
  </form>

  <script>
    const daysOfWeek = ["Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday"];
    const activities = ["School", "Art class", "Work"];
    const calendarContainer = document.getElementById('calendar-container');

    function createTimePicker(activity, day, uniqueId) {
      const timeField = document.createElement('div');
      timeField.innerHTML = `
        <label>${activity}:</label>
        <input type="time" name="${day}-${activity}-start-${uniqueId}">
        <input type="time" name="${day}-${activity}-end-${uniqueId}">
      `;
      return timeField;
    }

    function createDaySection(day) {
      const daySection = document.createElement('div');
      daySection.innerHTML = `<h2>${day}</h2>`;

      activities.forEach(activity => {
        const uniqueId = `${day}-${activity}-1`;
        const timeField = createTimePicker(activity, day, uniqueId);

        if (activity === "School") {
          const addButton = document.createElement('button');
          addButton.type = 'button';
          addButton.innerText = '+';
          addButton.onclick = () => addAdditionalTime(day);
          timeField.appendChild(addButton);
        }

        daySection.appendChild(timeField);
      });

      return daySection;
    }

    function addAdditionalTime(day) {
      const daySection = calendarContainer.querySelector(`div:has(h2:contains(${day}))`);
      const uniqueId = `additional-${Date.now()}`;
      const additionalTimeField = createTimePicker("School", day, uniqueId);
      daySection.appendChild(additionalTimeField);
    }

    daysOfWeek.forEach(day => {
      const daySection = createDaySection(day);
      calendarContainer.appendChild(daySection);
    });

    function generatePDF() {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();

      doc.setFontSize(18);
      doc.text("Weekly Calendar", 10, 10);

      let yPosition = 20;

      daysOfWeek.forEach(day => {
        doc.setFontSize(14);
        doc.text(day, 10, yPosition);
        yPosition += 10;

        activities.forEach(activity => {
          const startElements = document.querySelectorAll(`input[name^="${day}-${activity}-start"]`);
          const endElements = document.querySelectorAll(`input[name^="${day}-${activity}-end"]`);
          
          startElements.forEach((startElem, index) => {
            const start = startElem.value || "N/A";
            const end = endElements[index].value || "N/A";

            if (start || end) {
              doc.setFontSize(12);
              doc.text(`${activity}: ${start} - ${end}`, 20, yPosition);
              yPosition += 10;
            }
          });
        });

        yPosition += 5;
      });

      doc.save("Weekly_Calendar.pdf");
    }
  </script>
</body>
</html>
