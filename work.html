<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Weekly Calendar Form with Materialize Time Picker</title>
  
  <!-- Materialize CSS -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
  
  <style>
    /* ========== Original Unmodified CSS ========== */

    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      background-color: #f4f4f9;
    }
    
    /* Card Style */
    .mdc-card {
      background-color: #fff;
      padding: 20px;
      width: 100%;
      max-width: 600px;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      margin: 16px;
    }

    /* Typography */
    .mdc-typography--headline5 {
      font-size: 1.5rem;
      margin-bottom: 1rem;
      text-align: center;
    }
    .mdc-typography--headline6 {
      font-size: 1.2rem;
      margin-top: 1rem;
    }

    /* Layout Grid */
    .mdc-layout-grid {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    /* Text Field Style */
    .mdc-text-field {
    position: relative;
    display: flex;
    flex-direction: column;
    width: 50%;
    margin-top: 10px;
}
    
.mdc-text-field__input {
    font-size: 1rem;
    padding: 8px;
    border: 1px solid #ccc;
    border-radius: 4px;
    outline: none;
    transition: border-color 0.3s ease;
    width: 90%;
}
    
    .mdc-text-field__input:focus {
      border-color: #6200ee;
    }
    
    .mdc-floating-label {
    top: -10px;
    left: 10px;
    background-color: #fff;
    padding: 0 4px;
    font-size: 14px;
    color: #333;
    transition: 0.2s ease;
    pointer-events: none;
    display: block;
    margin-bottom: 10px;
    }

    /* Button Style */
    .mdc-button {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 8px 16px;
      font-size: 1rem;
      font-weight: bold;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      transition: background-color 0.3s ease;
      width: 100%;
    }
    
    .mdc-button--raised {
      background-color: #6200ee;
      color: #fff;
    }
    
    .mdc-button--raised:hover {
      background-color: #5a00e0;
    }
    
    .mdc-button--outlined {
        background-color: #49c6ff;
    border: none;
    color: #fff;
}
    
    .mdc-button--outlined:hover {
      background-color: #f4f4f9;
    }

    /* Additional Styling for Containers */
    .activity-container {
      margin-bottom: 20px;
    }

    /* Add Button Container Styling */
    .add-button-container {
      display: flex;
      justify-content: center;
      width: 100%;
      margin-top: 10px;
    }
/* ========== New/Modified CSS for Multi-Step Form ========== */

/* Time Fields in a Single Line */
.time-field-container {
  display: flex;
  justify-content: space-between;
  gap: 10px;
}

/* Button Container for Multi-Step Form */
.button-container {
  display: flex;
  justify-content: space-between;
  gap: 10px;
  margin-top: 20px;
}

/* Multi-Step Form: Hide Non-Active Steps */
.step {
  display: none;
}
.step.active {
  display: block;
}

  </style>
</head>
<body>

  <form id="weekly-calendar-form" class="mdc-card">
    <h1 class="mdc-typography--headline5">Weekly Calendar</h1>
    <div id="calendar-container" class="mdc-layout-grid"></div>

    <div class="button-container">
      <button type="button" class="mdc-button mdc-button--outlined" id="backButton" onclick="prevStep()" style="display:none;">Back</button>
      <button type="button" class="mdc-button mdc-button--raised" id="nextButton" onclick="nextStep()">Next</button>
      <button type="button" class="mdc-button mdc-button--raised" id="submitButton" onclick="generatePDF()" style="display:none;">Submit</button>
    </div>
  </form>

  <!-- Materialize JS and jsPDF -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.4.0/jspdf.umd.min.js"></script>

  <script>
    const daysOfWeek = ["Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday", "Sunday"];
    const activities = ["School", "Art class", "Work"];
    const calendarContainer = document.getElementById('calendar-container');

    let currentStep = 0;

    function initializeTimePicker(element) {
      M.Timepicker.init(element, {
        twelveHour: false,
        autoClose: true,
        onCloseEnd: () => element.blur()
      });
    }

    function createTimePicker(activity, day, uniqueId) {
      const timeFieldContainer = document.createElement('div');
      timeFieldContainer.classList.add('time-field-container');

      const startTimeField = document.createElement('div');
      startTimeField.classList.add('mdc-text-field');
      startTimeField.innerHTML = `
        <label class="mdc-floating-label">${activity} Start Time</label>
        <input type="text" id="${day}-${activity}-start-${uniqueId}" name="${day}-${activity}-start-${uniqueId}" class="mdc-text-field__input timepicker">
      `;

      const endTimeField = document.createElement('div');
      endTimeField.classList.add('mdc-text-field');
      endTimeField.innerHTML = `
        <label class="mdc-floating-label">${activity} End Time</label>
        <input type="text" id="${day}-${activity}-end-${uniqueId}" name="${day}-${activity}-end-${uniqueId}" class="mdc-text-field__input timepicker">
      `;

      timeFieldContainer.appendChild(startTimeField);
      timeFieldContainer.appendChild(endTimeField);

      setTimeout(() => {
        initializeTimePicker(document.getElementById(`${day}-${activity}-start-${uniqueId}`));
        initializeTimePicker(document.getElementById(`${day}-${activity}-end-${uniqueId}`));
      });

      return timeFieldContainer;
    }

    function createDaySection(day) {
      const daySection = document.createElement('div');
      daySection.classList.add('activity-container', 'step');
      daySection.innerHTML = `<h2 class="mdc-typography--headline6">${day}</h2>`;

      activities.forEach(activity => {
        const uniqueId = `${day}-${activity}-1`;

        const activityContainer = document.createElement('div');
        activityContainer.classList.add('activity-container');
        activityContainer.setAttribute('data-activity', activity);

        const timeField = createTimePicker(activity, day, uniqueId);

        if (activity === "School") {
          const schoolContainer = document.createElement('div');
          schoolContainer.classList.add('school-container');

          schoolContainer.appendChild(timeField);

          const addButtonContainer = document.createElement('div');
          addButtonContainer.classList.add('add-button-container');

          const addButton = document.createElement('button');
          addButton.type = 'button';
          addButton.classList.add('mdc-button', 'mdc-button--outlined');
          addButton.innerHTML = '+';
          addButton.onclick = () => addAdditionalTime(schoolContainer, addButtonContainer, day);

          addButtonContainer.appendChild(addButton);

          schoolContainer.appendChild(addButtonContainer);
          activityContainer.appendChild(schoolContainer);
        } else {
          activityContainer.appendChild(timeField);
        }

        daySection.appendChild(activityContainer);
      });

      return daySection;
    }

    function addAdditionalTime(schoolContainer, addButtonContainer, day) {
      const uniqueId = `additional-${Date.now()}`;
      const additionalTimeField = createTimePicker("School", day, uniqueId);
      schoolContainer.insertBefore(additionalTimeField, addButtonContainer);
    }

    daysOfWeek.forEach(day => {
      const daySection = createDaySection(day);
      calendarContainer.appendChild(daySection);
    });

    function updateStep() {
      const steps = document.querySelectorAll('.step');
      steps.forEach((step, index) => {
        step.classList.toggle('active', index === currentStep);
      });

      document.getElementById('backButton').style.display = currentStep === 0 ? 'none' : 'inline';
      document.getElementById('nextButton').style.display = currentStep === steps.length - 1 ? 'none' : 'inline';
      document.getElementById('submitButton').style.display = currentStep === steps.length - 1 ? 'inline' : 'none';
    }

    function nextStep() {
      const steps = document.querySelectorAll('.step');
      if (currentStep < steps.length - 1) {
        currentStep++;
        updateStep();
      }
    }

    function prevStep() {
      if (currentStep > 0) {
        currentStep--;
        updateStep();
      }
    }

    function generatePDF() {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();

      doc.setFontSize(18);
      doc.text("Weekly Calendar", 10, 10);

      let yPosition = 20;

      daysOfWeek.forEach(day => {
        doc.setFontSize(14);
        doc.text(day, 10, yPosition);
        yPosition += 10;

        let entries = [];

        activities.forEach(activity => {
          const startElements = document.querySelectorAll(`input[name^="${day}-${activity}-start"]`);
          const endElements = document.querySelectorAll(`input[name^="${day}-${activity}-end"]`);

          startElements.forEach((startElem, index) => {
            const startTime = startElem.value;
            const endTime = endElements[index] ? endElements[index].value : "N/A";

            if (startTime) {
              entries.push({
                activity: activity,
                startTime: startTime,
                endTime: endTime
              });
            }
          });
        });

        entries.sort((a, b) => a.startTime.localeCompare(b.startTime));

        entries.forEach(entry => {
          doc.setFontSize(12);
          doc.text(`${entry.activity}: ${entry.startTime} - ${entry.endTime}`, 20, yPosition);
          yPosition += 10;
        });

        yPosition += 5; // Space between days
      });

      doc.save("Weekly_Calendar.pdf");
    }

    updateStep(); // Initialize the first step
  </script>
</body>
</html>

