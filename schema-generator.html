<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JSON-LD Schema Generator</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Helvetica Neue', Arial, sans-serif;
            background: #fafafa;
            color: #1a1a1a;
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }

        header {
            background: #ffffff;
            padding: 2rem;
            border-bottom: 1px solid #e0e0e0;
            margin-bottom: 2rem;
        }

        h1 {
            font-size: 2rem;
            font-weight: 300;
            letter-spacing: -0.02em;
            margin-bottom: 0.5rem;
        }

        .subtitle {
            color: #666;
            font-size: 0.95rem;
        }

        .upload-section {
            background: #ffffff;
            padding: 2rem;
            border: 1px solid #e0e0e0;
            margin-bottom: 2rem;
        }

        .upload-zone {
            border: 2px dashed #ccc;
            padding: 3rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            background: #fafafa;
        }

        .upload-zone:hover {
            border-color: #999;
            background: #f5f5f5;
        }

        .upload-zone.dragover {
            border-color: #0066cc;
            background: #f0f7ff;
        }

        input[type="file"] {
            display: none;
        }

        button {
            background: #1a1a1a;
            color: #ffffff;
            border: none;
            padding: 0.75rem 2rem;
            font-size: 0.95rem;
            cursor: pointer;
            transition: background 0.2s;
            font-family: inherit;
        }

        button:hover:not(:disabled) {
            background: #333;
        }

        button:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        .progress-section {
            background: #ffffff;
            padding: 2rem;
            border: 1px solid #e0e0e0;
            margin-bottom: 2rem;
            display: none;
        }

        .progress-bar {
            width: 100%;
            height: 4px;
            background: #e0e0e0;
            margin: 1rem 0;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: #1a1a1a;
            width: 0%;
            transition: width 0.3s;
        }

        .status {
            color: #666;
            font-size: 0.9rem;
            margin-top: 1rem;
        }

        .results-section {
            background: #ffffff;
            padding: 2rem;
            border: 1px solid #e0e0e0;
            display: none;
        }

        .result-item {
            padding: 1rem;
            border-bottom: 1px solid #f0f0f0;
            display: grid;
            grid-template-columns: 1fr auto;
            gap: 1rem;
            align-items: center;
        }

        .result-item:last-child {
            border-bottom: none;
        }

        .result-url {
            font-size: 0.9rem;
            color: #666;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .result-actions {
            display: flex;
            gap: 0.5rem;
        }

        .btn-small {
            padding: 0.5rem 1rem;
            font-size: 0.85rem;
        }

        .download-all {
            margin-top: 2rem;
            padding-top: 2rem;
            border-top: 1px solid #e0e0e0;
        }

        .info-box {
            background: #f9f9f9;
            padding: 1rem;
            margin-bottom: 1rem;
            font-size: 0.9rem;
            color: #666;
            border-left: 3px solid #1a1a1a;
        }

        .error {
            color: #d32f2f;
            background: #ffebee;
            padding: 1rem;
            margin-top: 1rem;
            border-left: 3px solid #d32f2f;
        }

        pre {
            background: #f5f5f5;
            padding: 1rem;
            overflow-x: auto;
            font-size: 0.85rem;
            border: 1px solid #e0e0e0;
        }

        .schema-preview {
            display: none;
            margin-top: 1rem;
        }

        .html-preview {
            display: none;
            margin-top: 1rem;
            background: #ffffff;
            border: 1px solid #e0e0e0;
            padding: 1.5rem;
        }

        .html-preview iframe {
            width: 100%;
            min-height: 400px;
            border: 1px solid #e0e0e0;
            background: #ffffff;
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <h1>JSON-LD Schema Generator</h1>
            <p class="subtitle">Upload a spreadsheet of URLs to automatically generate structured data schemas</p>
        </div>
    </header>

    <div class="container">
        <div class="upload-section">
            <h2 style="margin-bottom: 1rem; font-weight: 400;">Upload Spreadsheet</h2>
            <div class="info-box">
                <strong>Supported formats:</strong> CSV, XLSX, XLS<br>
                <strong>Required:</strong> First column must contain URLs (with header "URL" or "url")<br>
                <strong>Optional columns:</strong> Page Type, Title, Description (used to generate schemas)
            </div>
            
            <div class="upload-zone" id="uploadZone">
                <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="#999" stroke-width="1.5" style="margin-bottom: 1rem;">
                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                    <polyline points="17 8 12 3 7 8"></polyline>
                    <line x1="12" y1="3" x2="12" y2="15"></line>
                </svg>
                <p style="color: #666; margin-bottom: 0.5rem;">Drop your spreadsheet here or click to browse</p>
                <p style="color: #999; font-size: 0.85rem;">CSV, XLSX, or XLS files</p>
                <input type="file" id="fileInput" accept=".csv,.xlsx,.xls">
            </div>

            <div style="margin-top: 1.5rem;">
                <button id="generateBtn" disabled>Generate Schemas</button>
            </div>
        </div>

        <div class="progress-section" id="progressSection">
            <h2 style="margin-bottom: 1rem; font-weight: 400;">Generating Schemas...</h2>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <div class="status" id="statusText">Preparing...</div>
        </div>

        <div class="results-section" id="resultsSection">
            <h2 style="margin-bottom: 1.5rem; font-weight: 400;">Generated Schemas</h2>
            <div id="resultsList"></div>
            <div class="download-all">
                <button id="downloadAllBtn">Download All Schemas (ZIP)</button>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <script>
        let uploadedData = [];
        let generatedSchemas = [];

        const uploadZone = document.getElementById('uploadZone');
        const fileInput = document.getElementById('fileInput');
        const generateBtn = document.getElementById('generateBtn');

        uploadZone.addEventListener('click', () => fileInput.click());

        uploadZone.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadZone.classList.add('dragover');
        });

        uploadZone.addEventListener('dragleave', () => {
            uploadZone.classList.remove('dragover');
        });

        uploadZone.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadZone.classList.remove('dragover');
            const file = e.dataTransfer.files[0];
            if (file) handleFile(file);
        });

        fileInput.addEventListener('change', (e) => {
            const file = e.target.files[0];
            if (file) handleFile(file);
        });

        function handleFile(file) {
            const reader = new FileReader();
            
            reader.onload = (e) => {
                try {
                    const data = new Uint8Array(e.target.result);
                    const workbook = XLSX.read(data, { type: 'array' });
                    const firstSheet = workbook.Sheets[workbook.SheetNames[0]];
                    const jsonData = XLSX.utils.sheet_to_json(firstSheet);
                    
                    if (jsonData.length === 0) {
                        alert('The spreadsheet appears to be empty');
                        return;
                    }

                    const firstRow = jsonData[0];
                    const urlKey = Object.keys(firstRow).find(key => 
                        key.toLowerCase() === 'url' || key.toLowerCase() === 'urls'
                    );

                    if (!urlKey) {
                        alert('Could not find a "URL" column in your spreadsheet. Please ensure the first column has a "URL" header.');
                        return;
                    }

                    uploadedData = jsonData.map(row => ({
                        url: row[urlKey],
                        pageType: row['Page Type'] || row['Type'] || row['type'] || '',
                        title: row['Title'] || row['title'] || '',
                        description: row['Description'] || row['description'] || ''
                    })).filter(row => row.url);

                    generateBtn.disabled = false;
                    uploadZone.querySelector('p').textContent = `✓ Loaded ${uploadedData.length} URLs`;
                    uploadZone.querySelector('p').style.color = '#2e7d32';
                } catch (error) {
                    console.error('Error parsing file:', error);
                    alert('Error parsing file. Please ensure it\'s a valid CSV or Excel file.');
                }
            };

            reader.readAsArrayBuffer(file);
        }

        generateBtn.addEventListener('click', async () => {
            if (uploadedData.length === 0) return;

            document.getElementById('progressSection').style.display = 'block';
            document.getElementById('resultsSection').style.display = 'none';
            generateBtn.disabled = true;

            generatedSchemas = [];
            const total = uploadedData.length;

            for (let i = 0; i < uploadedData.length; i++) {
                const item = uploadedData[i];
                updateProgress(i + 1, total, `Processing ${item.url}`);

                try {
                    const schema = generateSchemaForURL(item);
                    generatedSchemas.push({
                        url: item.url,
                        schema: JSON.stringify(schema, null, 2),
                        success: true
                    });
                } catch (error) {
                    console.error(`Error generating schema for ${item.url}:`, error);
                    generatedSchemas.push({
                        url: item.url,
                        error: error.message,
                        success: false
                    });
                }

                // Small delay to show progress
                await new Promise(resolve => setTimeout(resolve, 100));
            }

            displayResults();
            document.getElementById('progressSection').style.display = 'none';
            document.getElementById('resultsSection').style.display = 'block';
            generateBtn.disabled = false;
        });

        function generateSchemaForURL(item) {
            // Extract domain and path info from URL
            let url;
            try {
                url = new URL(item.url);
            } catch (e) {
                throw new Error('Invalid URL');
            }

            const domain = url.hostname;
            const cleanDomain = domain.replace('www.', '');
            const origin = url.origin;
            const path = url.pathname;
            const segments = path.split('/').filter(s => s);

            // Determine schema type based on URL patterns and provided info
            let schemaType = 'WebPage';
            
            if (item.pageType) {
                schemaType = item.pageType;
            } else {
                // Auto-detect from URL patterns
                if (path.includes('/blog/') || path.includes('/article/') || path.includes('/news/')) {
                    schemaType = 'Article';
                } else if (path.includes('/product/') || path.includes('/shop/')) {
                    schemaType = 'Product';
                } else if (path.includes('/faq')) {
                    schemaType = 'FAQPage';
                } else if (path.includes('/contact')) {
                    schemaType = 'ContactPage';
                } else if (path.includes('/about')) {
                    schemaType = 'AboutPage';
                }
            }

            // Generate page title
            let pageTitle = item.title;
            if (!pageTitle) {
                const lastSegment = segments[segments.length - 1] || cleanDomain;
                pageTitle = lastSegment
                    .replace(/-/g, ' ')
                    .replace(/\b\w/g, l => l.toUpperCase());
            }

            // Generate base schema with full structure
            const schema = {
                "@context": "https://schema.org",
                "@type": schemaType,
                "@id": `${item.url}#webpage`,
                "url": item.url,
                "name": pageTitle,
                "inLanguage": "en"
            };

            // Add description if provided
            if (item.description) {
                schema.description = item.description;
            }

            // Add isPartOf (parent website)
            schema.isPartOf = {
                "@type": "WebSite",
                "name": cleanDomain.split('.')[0].replace(/\b\w/g, l => l.toUpperCase()),
                "url": origin + "/"
            };

            // Add primary image
            schema.primaryImageOfPage = {
                "@type": "ImageObject",
                "url": `${origin}/logo.png` // Can be customized
            };

            // Add breadcrumbs for nested pages
            if (segments.length > 0) {
                const breadcrumbs = {
                    "@type": "BreadcrumbList",
                    "itemListElement": []
                };

                let currentPath = '';
                segments.forEach((segment, index) => {
                    currentPath += '/' + segment;
                    breadcrumbs.itemListElement.push({
                        "@type": "ListItem",
                        "position": index + 1,
                        "name": segment.replace(/-/g, ' ').replace(/\b\w/g, l => l.toUpperCase()),
                        "item": `${origin}${currentPath}`
                    });
                });

                schema.breadcrumb = breadcrumbs;
            }

            // Add comprehensive publisher/organization information
            schema.publisher = {
                "@type": "Organization",
                "@id": `${origin}/#organization`,
                "name": cleanDomain.split('.')[0].replace(/\b\w/g, l => l.toUpperCase()),
                "url": origin + "/",
                "logo": {
                    "@type": "ImageObject",
                    "url": `${origin}/logo.png`
                },
                "contactPoint": [
                    {
                        "@type": "ContactPoint",
                        "telephone": "+1-800-555-0000", // Customize this
                        "contactType": "customer service",
                        "areaServed": ["US"],
                        "availableLanguage": ["en"]
                    }
                ]
            };

            // Add type-specific properties
            switch (schemaType) {
                case 'Article':
                    schema.author = {
                        "@type": "Organization",
                        "@id": `${origin}/#organization`
                    };
                    schema.publisher = {
                        "@type": "Organization",
                        "@id": `${origin}/#organization`,
                        "name": cleanDomain.split('.')[0].replace(/\b\w/g, l => l.toUpperCase()),
                        "logo": {
                            "@type": "ImageObject",
                            "url": `${origin}/logo.png`
                        }
                    };
                    schema.headline = pageTitle;
                    schema.datePublished = new Date().toISOString().split('T')[0];
                    schema.dateModified = new Date().toISOString().split('T')[0];
                    schema.image = {
                        "@type": "ImageObject",
                        "url": `${origin}/article-image.jpg`
                    };
                    break;

                case 'Product':
                    schema.offers = {
                        "@type": "Offer",
                        "url": item.url,
                        "priceCurrency": "USD",
                        "availability": "https://schema.org/InStock",
                        "seller": {
                            "@type": "Organization",
                            "@id": `${origin}/#organization`
                        }
                    };
                    schema.brand = {
                        "@type": "Brand",
                        "name": cleanDomain.split('.')[0].replace(/\b\w/g, l => l.toUpperCase())
                    };
                    if (item.description) {
                        schema.description = item.description;
                    }
                    break;

                case 'ContactPage':
                    schema.mainEntity = {
                        "@type": "Organization",
                        "@id": `${origin}/#organization`,
                        "name": cleanDomain.split('.')[0].replace(/\b\w/g, l => l.toUpperCase()),
                        "url": origin + "/",
                        "contactPoint": [
                            {
                                "@type": "ContactPoint",
                                "telephone": "+1-800-555-0000",
                                "contactType": "customer service",
                                "areaServed": ["US"],
                                "availableLanguage": ["en"]
                            }
                        ]
                    };
                    break;

                case 'AboutPage':
                    schema.mainEntity = {
                        "@type": "Organization",
                        "@id": `${origin}/#organization`,
                        "name": cleanDomain.split('.')[0].replace(/\b\w/g, l => l.toUpperCase()),
                        "url": origin + "/",
                        "description": item.description || `Learn more about ${cleanDomain.split('.')[0]}`,
                        "logo": {
                            "@type": "ImageObject",
                            "url": `${origin}/logo.png`
                        }
                    };
                    break;

                case 'FAQPage':
                    schema.mainEntity = [
                        {
                            "@type": "Question",
                            "name": "Example Question 1",
                            "acceptedAnswer": {
                                "@type": "Answer",
                                "text": "This is a placeholder answer. Replace with actual FAQ content."
                            }
                        },
                        {
                            "@type": "Question",
                            "name": "Example Question 2",
                            "acceptedAnswer": {
                                "@type": "Answer",
                                "text": "This is a placeholder answer. Replace with actual FAQ content."
                            }
                        }
                    ];
                    break;
            }

            // Add potential actions for interactive pages
            schema.potentialAction = [
                {
                    "@type": "SearchAction",
                    "target": {
                        "@type": "EntryPoint",
                        "urlTemplate": `${origin}/search?q={search_term_string}`
                    },
                    "query-input": "required name=search_term_string"
                }
            ];

            return schema;
        }

        function updateProgress(current, total, status) {
            const percent = (current / total) * 100;
            document.getElementById('progressFill').style.width = percent + '%';
            document.getElementById('statusText').textContent = `${status} (${current}/${total})`;
        }

        function displayResults() {
            const resultsList = document.getElementById('resultsList');
            resultsList.innerHTML = '';

            generatedSchemas.forEach((result, index) => {
                const item = document.createElement('div');
                item.className = 'result-item';
                
                const urlDiv = document.createElement('div');
                urlDiv.innerHTML = `
                    <div class="result-url">${result.url}</div>
                    ${result.success ? '<span style="color: #2e7d32; font-size: 0.85rem;">✓ Generated</span>' : '<span style="color: #d32f2f; font-size: 0.85rem;">✗ Error</span>'}
                `;

                const actionsDiv = document.createElement('div');
                actionsDiv.className = 'result-actions';

                if (result.success) {
                    const viewBtn = document.createElement('button');
                    viewBtn.textContent = 'View JSON';
                    viewBtn.className = 'btn-small';
                    viewBtn.onclick = () => togglePreview(index);

                    const viewHtmlBtn = document.createElement('button');
                    viewHtmlBtn.textContent = 'View HTML';
                    viewHtmlBtn.className = 'btn-small';
                    viewHtmlBtn.onclick = () => toggleHtmlPreview(index);

                    const copyBtn = document.createElement('button');
                    copyBtn.textContent = 'Copy JSON';
                    copyBtn.className = 'btn-small';
                    copyBtn.onclick = () => {
                        navigator.clipboard.writeText(result.schema);
                        copyBtn.textContent = 'Copied!';
                        setTimeout(() => copyBtn.textContent = 'Copy JSON', 2000);
                    };

                    const downloadBtn = document.createElement('button');
                    downloadBtn.textContent = 'Download';
                    downloadBtn.className = 'btn-small';
                    downloadBtn.onclick = () => downloadSchema(result, index);

                    actionsDiv.appendChild(viewBtn);
                    actionsDiv.appendChild(viewHtmlBtn);
                    actionsDiv.appendChild(copyBtn);
                    actionsDiv.appendChild(downloadBtn);
                }

                item.appendChild(urlDiv);
                item.appendChild(actionsDiv);
                resultsList.appendChild(item);

                if (result.success) {
                    const preview = document.createElement('div');
                    preview.className = 'schema-preview';
                    preview.id = `preview-${index}`;
                    preview.innerHTML = `<pre>${escapeHtml(result.schema)}</pre>`;
                    item.appendChild(preview);

                    const htmlPreview = document.createElement('div');
                    htmlPreview.className = 'html-preview';
                    htmlPreview.id = `html-preview-${index}`;
                    item.appendChild(htmlPreview);
                }
            });
        }

        function togglePreview(index) {
            const preview = document.getElementById(`preview-${index}`);
            preview.style.display = preview.style.display === 'none' || !preview.style.display ? 'block' : 'none';
        }

        function toggleHtmlPreview(index) {
            const htmlPreview = document.getElementById(`html-preview-${index}`);
            const isVisible = htmlPreview.style.display === 'block';
            
            if (!isVisible) {
                // Generate and display HTML
                const schema = generatedSchemas[index].schema;
                const htmlContent = generateHTMLFromSchema(schema);
                htmlPreview.innerHTML = htmlContent;
                htmlPreview.style.display = 'block';
            } else {
                htmlPreview.style.display = 'none';
            }
        }

        function generateHTMLFromSchema(schemaJson) {
            const schema = JSON.parse(schemaJson);
            
            let html = '<div style="font-family: -apple-system, BlinkMacSystemFont, \'Segoe UI\', sans-serif;">';
            html += '<h3 style="margin: 0 0 1rem 0; font-weight: 400;">' + escapeHtml(schema.name || 'Page') + '</h3>';
            
            if (schema.description) {
                html += '<p style="color: #666; margin-bottom: 1.5rem;">' + escapeHtml(schema.description) + '</p>';
            }

            // Schema Type and ID
            html += '<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem; margin-bottom: 1.5rem;">';
            html += '<div style="background: #f9f9f9; padding: 1rem; border-left: 3px solid #1a1a1a;">';
            html += '<div style="font-size: 0.85rem; color: #666; margin-bottom: 0.5rem;">Schema Type</div>';
            html += '<div style="font-weight: 500;">' + escapeHtml(schema['@type']) + '</div>';
            html += '</div>';
            
            html += '<div style="background: #f9f9f9; padding: 1rem; border-left: 3px solid #1a1a1a;">';
            html += '<div style="font-size: 0.85rem; color: #666; margin-bottom: 0.5rem;">Language</div>';
            html += '<div style="font-weight: 500;">' + escapeHtml(schema.inLanguage || 'en') + '</div>';
            html += '</div>';
            html += '</div>';

            // Publisher/Organization info
            if (schema.publisher) {
                html += '<div style="background: #fafafa; padding: 1.5rem; margin-bottom: 1.5rem; border: 1px solid #e0e0e0;">';
                html += '<div style="font-size: 0.9rem; font-weight: 500; margin-bottom: 1rem;">Publisher</div>';
                html += '<div style="margin-bottom: 0.5rem;"><strong>Name:</strong> ' + escapeHtml(schema.publisher.name) + '</div>';
                html += '<div style="margin-bottom: 0.5rem;"><strong>URL:</strong> <a href="' + escapeHtml(schema.publisher.url) + '" target="_blank" style="color: #0066cc;">' + escapeHtml(schema.publisher.url) + '</a></div>';
                
                if (schema.publisher.contactPoint && schema.publisher.contactPoint.length > 0) {
                    html += '<div style="margin-top: 1rem; padding-top: 1rem; border-top: 1px solid #e0e0e0;">';
                    html += '<div style="font-size: 0.85rem; color: #666; margin-bottom: 0.5rem;">Contact Points</div>';
                    schema.publisher.contactPoint.forEach(contact => {
                        html += '<div style="margin: 0.5rem 0; padding: 0.5rem; background: #fff; border-left: 2px solid #1a1a1a;">';
                        html += escapeHtml(contact.contactType) + ': ' + escapeHtml(contact.telephone || 'N/A');
                        html += '</div>';
                    });
                    html += '</div>';
                }
                
                html += '</div>';
            }

            // Breadcrumbs
            if (schema.breadcrumb && schema.breadcrumb.itemListElement) {
                html += '<div style="margin-bottom: 1.5rem;">';
                html += '<div style="font-size: 0.85rem; color: #666; margin-bottom: 0.5rem;">Breadcrumbs</div>';
                html += '<div style="display: flex; gap: 0.5rem; align-items: center; flex-wrap: wrap;">';
                
                schema.breadcrumb.itemListElement.forEach((item, idx) => {
                    if (idx > 0) {
                        html += '<span style="color: #999;">/</span>';
                    }
                    html += '<span style="background: #f0f0f0; padding: 0.25rem 0.75rem; border-radius: 2px; font-size: 0.85rem;">';
                    html += escapeHtml(item.name);
                    html += '</span>';
                });
                
                html += '</div></div>';
            }

            // Type-specific content
            if (schema['@type'] === 'Article') {
                html += '<div style="background: #fafafa; padding: 1.5rem; margin-bottom: 1.5rem; border: 1px solid #e0e0e0;">';
                html += '<div style="font-size: 0.9rem; font-weight: 500; margin-bottom: 1rem;">Article Information</div>';
                
                if (schema.author) {
                    html += '<div style="margin-bottom: 0.5rem;"><strong>Author:</strong> ' + escapeHtml(schema.author.name || schema.author['@type']) + '</div>';
                }
                
                if (schema.datePublished) {
                    html += '<div style="margin-bottom: 0.5rem;"><strong>Published:</strong> ' + escapeHtml(schema.datePublished) + '</div>';
                }
                
                if (schema.dateModified) {
                    html += '<div style="margin-bottom: 0.5rem;"><strong>Modified:</strong> ' + escapeHtml(schema.dateModified) + '</div>';
                }
                
                html += '</div>';
            }

            if (schema['@type'] === 'Product') {
                html += '<div style="background: #fafafa; padding: 1.5rem; margin-bottom: 1.5rem; border: 1px solid #e0e0e0;">';
                html += '<div style="font-size: 0.9rem; font-weight: 500; margin-bottom: 1rem;">Product Information</div>';
                
                if (schema.brand) {
                    html += '<div style="margin-bottom: 0.5rem;"><strong>Brand:</strong> ' + escapeHtml(schema.brand.name) + '</div>';
                }
                
                if (schema.offers) {
                    html += '<div style="margin-top: 1rem; padding: 1rem; background: #f0f7ff; border-radius: 4px;">';
                    html += '<div style="color: #2e7d32; font-weight: 500;">✓ In Stock</div>';
                    if (schema.offers.priceCurrency) {
                        html += '<div style="margin-top: 0.5rem; font-size: 0.9rem; color: #666;">Currency: ' + escapeHtml(schema.offers.priceCurrency) + '</div>';
                    }
                    html += '</div>';
                }
                
                html += '</div>';
            }

            if (schema.mainEntity && schema['@type'] === 'FAQPage') {
                html += '<div style="background: #fafafa; padding: 1.5rem; margin-bottom: 1.5rem; border: 1px solid #e0e0e0;">';
                html += '<div style="font-size: 0.9rem; font-weight: 500; margin-bottom: 1rem;">FAQ Questions</div>';
                
                if (Array.isArray(schema.mainEntity)) {
                    schema.mainEntity.forEach((faq, idx) => {
                        html += '<div style="margin-bottom: 1rem; padding: 1rem; background: #fff; border-left: 3px solid #1a1a1a;">';
                        html += '<div style="font-weight: 500; margin-bottom: 0.5rem;">' + escapeHtml(faq.name) + '</div>';
                        if (faq.acceptedAnswer) {
                            html += '<div style="color: #666; font-size: 0.9rem;">' + escapeHtml(faq.acceptedAnswer.text) + '</div>';
                        }
                        html += '</div>';
                    });
                }
                
                html += '</div>';
            }

            // Potential Actions
            if (schema.potentialAction && schema.potentialAction.length > 0) {
                html += '<div style="background: #fafafa; padding: 1.5rem; margin-bottom: 1.5rem; border: 1px solid #e0e0e0;">';
                html += '<div style="font-size: 0.9rem; font-weight: 500; margin-bottom: 1rem;">Available Actions</div>';
                
                schema.potentialAction.forEach(action => {
                    html += '<div style="margin-bottom: 0.5rem; padding: 0.5rem; background: #fff; border-left: 2px solid #1a1a1a;">';
                    html += '<strong>' + escapeHtml(action['@type']) + '</strong>';
                    if (action.name) {
                        html += ': ' + escapeHtml(action.name);
                    }
                    html += '</div>';
                });
                
                html += '</div>';
            }

            // URL
            html += '<div style="margin-top: 1.5rem; padding-top: 1.5rem; border-top: 1px solid #e0e0e0;">';
            html += '<div style="font-size: 0.85rem; color: #666; margin-bottom: 0.25rem;">Canonical URL</div>';
            html += '<a href="' + escapeHtml(schema.url) + '" target="_blank" style="color: #0066cc; text-decoration: none; word-break: break-all;">';
            html += escapeHtml(schema.url);
            html += '</a></div>';

            html += '</div>';
            
            return html;
        }

        function downloadSchema(result, index) {
            const blob = new Blob([result.schema], { type: 'application/json' });
            const filename = `schema-${index + 1}.json`;
            saveAs(blob, filename);
        }

        document.getElementById('downloadAllBtn').addEventListener('click', async () => {
            const zip = new JSZip();
            
            generatedSchemas.forEach((result, index) => {
                if (result.success) {
                    zip.file(`schema-${index + 1}.json`, result.schema);
                }
            });

            const content = await zip.generateAsync({ type: 'blob' });
            saveAs(content, 'schemas.zip');
        });

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }
    </script>
</body>
</html>